name: Trivy Image Scan

on:
  workflow_dispatch:
  schedule:
    - cron: "0 6 * * *"

jobs:
  call-image-scan-registry-mem:
    uses: Apicurio/apicurio-gh-workflows/.github/workflows/image-scan.yaml@main
    with:
      image: quay.io/apicurio/apicurio-registry-mem:latest-snapshot

  call-image-scan-registry-sql:
    uses: Apicurio/apicurio-gh-workflows/.github/workflows/image-scan.yaml@main
    with:
      image: quay.io/apicurio/apicurio-registry-sql:latest-snapshot

  call-image-scan-registry-kafkasql:
    uses: Apicurio/apicurio-gh-workflows/.github/workflows/image-scan.yaml@main
    with:
      image: quay.io/apicurio/apicurio-registry-kafkasql:latest-snapshot

