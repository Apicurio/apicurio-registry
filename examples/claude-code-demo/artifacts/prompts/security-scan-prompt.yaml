$schema: https://apicur.io/schemas/prompt-template/v1
templateId: security-scan-prompt
name: Security Vulnerability Scanner
version: "1.0.0"

template: |
  You are a security expert performing a comprehensive security analysis.

  ## Code to Analyze
  Language: {{language}}
  File: {{filename}}
  Framework: {{framework}}

  ```{{language}}
  {{code}}
  ```

  ## Scan Configuration
  Severity Threshold: {{severity_threshold}}
  {{#if scan_dependencies}}
  Include dependency analysis for known CVEs.
  {{/if}}

  ## Security Categories to Check
  {{#if categories}}
  Focus on: {{categories}}
  {{else}}
  Check for all OWASP Top 10 vulnerabilities:
  - A01: Broken Access Control
  - A02: Cryptographic Failures
  - A03: Injection
  - A04: Insecure Design
  - A05: Security Misconfiguration
  - A06: Vulnerable Components
  - A07: Authentication Failures
  - A08: Data Integrity Failures
  - A09: Logging Failures
  - A10: Server-Side Request Forgery
  {{/if}}

  ## Output Format
  Provide findings in {{output_format}} format.

variables:
  language:
    type: string
    description: "Programming language of the code"
    required: true
  filename:
    type: string
    description: "Name of the file being scanned"
    required: true
  code:
    type: string
    description: "The code to scan for vulnerabilities"
    required: true
  framework:
    type: string
    description: "Framework used (e.g., Spring, Express, Django)"
    required: false
  severity_threshold:
    type: string
    enum: ["critical", "high", "medium", "low", "info"]
    default: "medium"
    description: "Minimum severity level to report"
  scan_dependencies:
    type: boolean
    default: true
    description: "Whether to scan dependencies for CVEs"
  categories:
    type: string
    description: "Specific security categories to focus on"
    required: false
  output_format:
    type: string
    enum: ["sarif", "json", "markdown"]
    default: "sarif"
    description: "Output format for security findings"

outputSchema:
  type: object
  properties:
    summary:
      type: object
      properties:
        total_findings:
          type: integer
        critical:
          type: integer
        high:
          type: integer
        medium:
          type: integer
        low:
          type: integer
    findings:
      type: array
      items:
        type: object
        properties:
          id:
            type: string
          severity:
            type: string
            enum: ["critical", "high", "medium", "low", "info"]
          category:
            type: string
          title:
            type: string
          description:
            type: string
          location:
            type: object
            properties:
              file:
                type: string
              line:
                type: integer
              column:
                type: integer
          remediation:
            type: string
          references:
            type: array
            items:
              type: string

metadata:
  estimatedTokens: 1000
  recommendedModels: ["claude-opus-4-5"]
  tags: ["security", "vulnerability", "owasp", "scanning"]
